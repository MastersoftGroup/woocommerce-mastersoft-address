/*@preserve mastersoft/woocommerce-mastersoft-address*/
jQuery(document).ready(function($){function init(){configs=function(){var result={username:void 0,password:void 0,url:"https://hosted.mastersoftgroup.com",AU:{locale:Harmony.AUSTRALIA,sot:Harmony.GNAF,featureOptions:{singleLineHitNumber:5,caseType:"TITLE"}},NZ:{locale:Harmony.NEW_ZEALAND,sot:Harmony.NZAD,featureOptions:{singleLineHitNumber:5,caseType:"TITLE",exposeAttributes:"1"}}},key=php_vars.licenceKey,url=php_vars.url,options=php_vars.widgetOptions,optionsAu=php_vars.widgetOptionsAu,optionsNz=php_vars.widgetOptionsNz,hasUsernamePassword=!1;if("undefined"!=typeof key&&key&&key.indexOf(":")>0){var i=key.indexOf(":"),username=key.substring(0,i),password=key.substring(i+1,key.length);if(username&&password){hasUsernamePassword=!0,result.username=username,result.password=password,"undefined"!=typeof url&&url&&(result.url=url);var obj,value;"undefined"!=typeof options&&options&&(obj=eval("(["+options+"])")[0],Object.keys(obj).forEach(function(e){value=obj[e],"sot"!==e&&(result.AU.featureOptions[e]=value,result.NZ.featureOptions[e]=value)})),"undefined"!=typeof optionsAu&&optionsAu&&(obj=eval("(["+optionsAu+"])")[0],Object.keys(obj).forEach(function(e){value=obj[e],"sot"===e?result.AU.sot=value:result.AU.featureOptions[e]=value})),"undefined"!=typeof optionsNz&&optionsNz&&(obj=eval("(["+optionsNz+"])")[0],Object.keys(obj).forEach(function(e){value=obj[e],"sot"===e?result.NZ.sot=value:result.NZ.featureOptions[e]=value}))}}return console.info("Licence key is in "+(hasUsernamePassword?"VALID":"INVALID")+" format, URL: "+url+", Options: "+options+", AU Options: "+optionsAu+", NZ Options: "+optionsNz),result}(),nzRegions=php_vars.nzRegionsValKey,$(BILLING_PREFIX+"country").data("val",$(BILLING_PREFIX+"country").val()),$(SHIPPING_PREFIX+"country").data("val",$(SHIPPING_PREFIX+"country").val())}function executeTasksForOnChangeCountry(e){var o=$(e+"country").val(),n=$(e+"country").data("val");"undefined"!=typeof n&&n&&o!==n&&($(e+"address_1").val(""),$(e+"address_2").val(""),$(e+"city").val(""),$(e+"state").val(""),$(e+"postcode").val(""),main(o,e))}function main(e,o){function n(e){autocompleteInstances[e]&&(autocompleteInstances[e].destroy(),autocompleteInstances[e]=null)}function t(e,o,n,t,s,a,r){function i(e){var o="";if(e.attributes&&e.attributes.regional_council_name){var n=e.attributes.regional_council_name.toUpperCase();n.endsWith(" REGION")&&(n=n.substring(0,n.length-7)),o=nzRegions[n.replace(/[^A-Za-z0-9]/g,"")]}return o}if(!$(r+"address_1").length)return void console.error("address_1 field not found");if(!$(r+"country").length)return void console.error("country field not found");Harmony.useEnv(e),Harmony.useProtocol(Harmony.JSONP),Harmony.init(o,n,t),Harmony.useFeatureOptions(a);var u={minLength:3,getIntlGeocode:!1,onRetrieve:function(e){var o=e.onRetrieveItem,n=[o.streetNumber,o.street].filter(Boolean).join(" "),s=[o.buildingName,o.subdwelling,n,o.postal].filter(Boolean).join(", ");$(r+"address_1").val(s);var a=t==Harmony.AUSTRALIA?o.locality:[o.suburb,o.townCity].filter(Boolean).join(", ");$(r+"city").val(a).change();var u=t==Harmony.AUSTRALIA?o.state.toUpperCase():i(o);$(r+"state").val(u).change(),$(r+"postcode").val(o.postcode)}},l=HarmonyJS.addressLookup($(r+"address_1").get(0),$(r+"country").get(0),null,u);autocompleteInstances[r]=l.autocomplete}n(o);var s,a,r;e&&"undefined"!=typeof configs[e]&&configs[e]&&(s=configs[e].locale,a=configs[e].sot,r=configs[e].featureOptions);var i=configs.username,u=configs.password,l=configs.url,c=Boolean("undefined"!=typeof i&&i&&"undefined"!=typeof u&&u&&"undefined"!=typeof s&&s&&"undefined"!=typeof a&&a);c&&t(l,i,u,s,a,r,o)}console.info("Mastersoft Address Autocomplete is ready."),console.info("Using jquery "+$.fn.jquery);var configs,nzRegions,BILLING_PREFIX="#billing_",SHIPPING_PREFIX="#shipping_",autocompleteInstances={};init(),$(BILLING_PREFIX+"country").length&&main($(BILLING_PREFIX+"country").val(),BILLING_PREFIX),$(SHIPPING_PREFIX+"country").length&&main($(SHIPPING_PREFIX+"country").val(),SHIPPING_PREFIX),$("#billing_country").change(function(){executeTasksForOnChangeCountry(BILLING_PREFIX),$(this).data("val",$(this).val())}),$("#shipping_country").change(function(){executeTasksForOnChangeCountry(SHIPPING_PREFIX),$(this).data("val",$(this).val())})});